import{u as e,s as a,r as s,v as l,x as o,b0 as t,b as i,o as u,g as n,n as d,c,f as r,y as v,m as p,t as f,F as m,c3 as b,E as h,c4 as y,c5 as w}from"./index.4bf722b3.js";import{u as L,z as _,a as k}from"./useExcel.35fcdafa.js";import"./index.bfe593bd.js";const E={class:"minions-content"},S={class:"minions-head"},C=d("div",null,null,-1),x={class:"btn-cont"},g={class:"minions-body"},U=d("a",null,"删除",-1),q=d("div",{class:"info-header"},"新增股票",-1),P={class:"info-content"},j={key:0,style:{color:"red"}},B={key:1},z={__name:"stockMyCare",setup(z){const I=e(),M=a({codeList:[],isEditShow:!1}),A={code:"",buyPrice:"",stopSurplus:"",stopLoss:"",house:"",name:"",isExist:"",industry:""},D=s(l(A)),{columns:F,searchStockList:T,stocksList:Y,onCodeChange:Z,onAddZcwStock:$,zcwlist:G,onBuyPriceBlur:H,onEditStock:J}=L(),{exportEecel:K}=k(),N=async()=>{const{code:e,name:a,isExist:s}=D.value;if(6!=e.length)return void h.warn("请输入正确的股票代码");if(M.codeList.includes(e))return void h.warn("股票已存在");if(s){if(!(await J(D.value)))return void h.error("修改股票失败")}else{if(!(await $(D.value)))return void h.error("新增股票失败")}let o={code:e};const{errcode:t,data:i}=await y(o);0==t&&(h.success("新增成功"),M.isEditShow=!1,D.value=l(A),R())};let O=null;const Q=()=>{O&&(clearInterval(O),O=null)},R=async()=>{const{errcode:e,data:a}=await w({});0==e&&(M.codeList=a.map((e=>e.code)),Q(),T(M.codeList),O=setInterval((()=>{T(M.codeList)}),5e3))},V=()=>{K(Y.value,F,`我的自选_${I.getters.getYMDate}`)};return o((()=>{R()})),t((()=>{Q()})),(e,a)=>{const s=i("a-button"),l=i("a-popconfirm"),o=i("a-input"),t=i("a-form-item"),y=i("a-input-number"),w=i("a-form"),L=i("a-modal");return u(),n(m,null,[d("div",E,[d("div",S,[C,d("div",x,[c(s,{onClick:a[0]||(a[0]=e=>M.isEditShow=!0)},{default:r((()=>[v("新增")])),_:1}),c(s,{onClick:V},{default:r((()=>[v("导出")])),_:1}),c(s,{type:"primary",onClick:a[1]||(a[1]=e=>p(T)(M.codeList))},{default:r((()=>[v("刷新")])),_:1})])]),d("div",g,[c(_,{columns:p(F),stocksList:p(Y)},{default:r((e=>[c(l,{title:"确定要删除这个股票?",onConfirm:a=>(async e=>{const a={code:e},{errcode:s,data:l}=await b(a);0==s&&(h.success("删除成功"),M.codeList=M.codeList.filter((a=>a!=e)),T(M.codeList))})(e.record.code)},{default:r((()=>[U])),_:2},1032,["onConfirm"])])),_:1},8,["columns","stocksList"])])]),c(L,{class:"infoTips",visible:M.isEditShow,"onUpdate:visible":a[9]||(a[9]=e=>M.isEditShow=e),width:"400px",onCancel:a[10]||(a[10]=e=>M.isEditShow=!1)},{title:r((()=>[q])),footer:r((()=>[c(s,{onClick:a[8]||(a[8]=e=>M.isEditShow=!1)},{default:r((()=>[v("取消")])),_:1}),c(s,{type:"primary",onClick:N},{default:r((()=>[v("确定")])),_:1})])),default:r((()=>[d("div",P,[c(w,{model:D.value,"label-col":{span:6},"wrapper-col":{span:18},autocomplete:"off"},{default:r((()=>[c(t,{label:"股票代码",rules:[{required:!0}]},{default:r((()=>[c(o,{value:D.value.code,"onUpdate:value":a[2]||(a[2]=e=>D.value.code=e),style:{width:"35%"},placeholder:"股票代码",onChange:a[3]||(a[3]=e=>p(Z)(D.value))},null,8,["value"]),v("   "),M.codeList.includes(D.value.code)?(u(),n("span",j,f(D.value.name)+"（已存在） ",1)):(u(),n("span",B,f(D.value.name)+f(D.value.industry),1))])),_:1}),c(t,{label:"买入价",rules:[{required:!0}]},{default:r((()=>[c(y,{value:D.value.buyPrice,"onUpdate:value":a[4]||(a[4]=e=>D.value.buyPrice=e),min:0,placeholder:"请输入股票买入价格",onBlur:a[5]||(a[5]=e=>p(H)(D.value))},null,8,["value"])])),_:1}),c(t,{label:"止盈",rules:[{required:!0}]},{default:r((()=>[c(y,{value:D.value.stopSurplus,"onUpdate:value":a[6]||(a[6]=e=>D.value.stopSurplus=e),min:0,placeholder:"请输入股票止盈价格"},null,8,["value"])])),_:1}),c(t,{label:"止损",rules:[{required:!0}]},{default:r((()=>[c(y,{value:D.value.stopLoss,"onUpdate:value":a[7]||(a[7]=e=>D.value.stopLoss=e),min:0,placeholder:"请输入股票止损价格"},null,8,["value"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["visible"])],64)}}};export{z as default};
