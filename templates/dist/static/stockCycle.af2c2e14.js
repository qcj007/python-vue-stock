import{u as e,s as a,r as s,v as l,x as o,b as t,o as i,g as u,n,c as d,f as c,y as r,m as v,t as p,F as f,bX as m,E as b,bY as h,bZ as y}from"./index.4bf722b3.js";import{u as w,z as L,a as _}from"./useExcel.35fcdafa.js";import"./index.bfe593bd.js";const k={class:"minions-content"},E={class:"minions-head"},S=n("div",null,null,-1),C={class:"btn-cont"},x={class:"minions-body"},g=n("a",null,"删除",-1),U=n("div",{class:"info-header"},"新增股票",-1),q={class:"info-content"},P={key:0,style:{color:"red"}},j={key:1},B={__name:"stockCycle",setup(B){const z=e(),Y=a({codeList:[],isEditShow:!1}),Z={code:"",buyPrice:"",stopSurplus:"",stopLoss:"",house:"",name:"",isExist:"",industry:""},A=s(l(Z)),{columns:D,searchStockList:F,stocksList:M,onCodeChange:T,onAddZcwStock:X,zcwlist:$,onBuyPriceBlur:G,onEditStock:H}=w(),{exportEecel:I}=_(),J=async()=>{const{code:e,name:a,isExist:s}=A.value;if(6!=e.length)return void b.warn("请输入正确的股票代码");if(Y.codeList.includes(e))return void b.warn("股票已存在");if(s){if(!(await H(A.value)))return void b.error("修改股票失败")}else{if(!(await X(A.value)))return void b.error("新增股票失败")}let o={code:e};const{errcode:t,data:i}=await h(o);0==t&&(b.success("新增成功"),Y.isEditShow=!1,A.value=l(Z),K())},K=async()=>{const{errcode:e,data:a}=await y({});0==e&&(Y.codeList=a.map((e=>e.code)),F(Y.codeList))},N=()=>{I(M.value,D,`支撑位_${z.getters.getYMDate}`)};return o((()=>{K()})),(e,a)=>{const s=t("a-button"),l=t("a-popconfirm"),o=t("a-input"),h=t("a-form-item"),y=t("a-input-number"),w=t("a-form"),_=t("a-modal");return i(),u(f,null,[n("div",k,[n("div",E,[S,n("div",C,[d(s,{onClick:a[0]||(a[0]=e=>Y.isEditShow=!0)},{default:c((()=>[r("新增")])),_:1}),d(s,{onClick:N},{default:c((()=>[r("导出")])),_:1}),d(s,{type:"primary",onClick:a[1]||(a[1]=e=>v(F)(Y.codeList))},{default:c((()=>[r("刷新")])),_:1})])]),n("div",x,[d(L,{columns:v(D),stocksList:v(M)},{default:c((e=>[d(l,{title:"确定要删除这个股票?",onConfirm:a=>(async e=>{const a={code:e},{errcode:s,data:l}=await m(a);0==s&&(b.success("删除成功"),Y.codeList=Y.codeList.filter((a=>a!=e)),F(Y.codeList))})(e.record.code)},{default:c((()=>[g])),_:2},1032,["onConfirm"])])),_:1},8,["columns","stocksList"])])]),d(_,{class:"infoTips",visible:Y.isEditShow,"onUpdate:visible":a[9]||(a[9]=e=>Y.isEditShow=e),width:"400px",onCancel:a[10]||(a[10]=e=>Y.isEditShow=!1)},{title:c((()=>[U])),footer:c((()=>[d(s,{onClick:a[8]||(a[8]=e=>Y.isEditShow=!1)},{default:c((()=>[r("取消")])),_:1}),d(s,{type:"primary",onClick:J},{default:c((()=>[r("确定")])),_:1})])),default:c((()=>[n("div",q,[d(w,{model:A.value,"label-col":{span:6},"wrapper-col":{span:18},autocomplete:"off"},{default:c((()=>[d(h,{label:"股票代码",rules:[{required:!0}]},{default:c((()=>[d(o,{value:A.value.code,"onUpdate:value":a[2]||(a[2]=e=>A.value.code=e),style:{width:"35%"},placeholder:"股票代码",onChange:a[3]||(a[3]=e=>v(T)(A.value))},null,8,["value"]),r("   "),Y.codeList.includes(A.value.code)?(i(),u("span",P,p(A.value.name)+"（已存在）",1)):(i(),u("span",j,p(A.value.name)+p(A.value.industry),1))])),_:1}),d(h,{label:"买入价",rules:[{required:!0}]},{default:c((()=>[d(y,{value:A.value.buyPrice,"onUpdate:value":a[4]||(a[4]=e=>A.value.buyPrice=e),min:0,placeholder:"请输入股票买入价格",onBlur:a[5]||(a[5]=e=>v(G)(A.value))},null,8,["value"])])),_:1}),d(h,{label:"止盈",rules:[{required:!0}]},{default:c((()=>[d(y,{value:A.value.stopSurplus,"onUpdate:value":a[6]||(a[6]=e=>A.value.stopSurplus=e),min:0,placeholder:"请输入股票止盈价格"},null,8,["value"])])),_:1}),d(h,{label:"止损",rules:[{required:!0}]},{default:c((()=>[d(y,{value:A.value.stopLoss,"onUpdate:value":a[7]||(a[7]=e=>A.value.stopLoss=e),min:0,placeholder:"请输入股票止损价格"},null,8,["value"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["visible"])],64)}}};export{B as default};
